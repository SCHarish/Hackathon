@model KIOSK.Models.OTP
@using System.Configuration;
@{
    String checkmrno = ConfigurationManager.AppSettings["checkmrno"];
    Layout = null;

}

<html>
<head>
    <link rel="stylesheet" href="~/Content/bootstrap.css" />
    <link rel="stylesheet" href="~/Content/font-awesome.css">
    <link rel="stylesheet" href="~/Content/animate.css">
    <script type="text/javascript" src="~/Scripts/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="~/Scripts/jquery.validate.js"></script>
    <script type="text/javascript" src="~/Scripts/jquery-ui.js"></script>
    <script type="text/javascript" src="~/Scripts/jquery-1.11.1.js"></script>
    <link rel="stylesheet" href='~/Content/jquery-ui.css' />

    <style type="text/css">
        #errmsg {
            color: red;
        }
      /*  img {
    width: 100%;
}*/
         body {
            background: #efefef url(gray_jean.png);
        }

        #ui-preview {
            border: 5px solid #ddd;
            margin: 30px;
            background: #fff;
            padding: 0 0 20px;
        }

            #ui-preview h1 {
                background: #000;
                font-size: 23px;
                color: #fff;
                padding: 10px 0 10px 20px;
                margin: 0 0 20px;
            }

        legend {
            width: auto;
            border-bottom: none;
            padding: 0 10px;
            margin-bottom: 0;
        }

        fieldset {
            padding: 0.35em 0.625em 0.75em !important;
            margin: 0 2px 10px !important;
            border: 1px solid #c0c0c0 !important;
        }

        .form-group {
            margin: 0 10px;
        }

        label {
            display: inline-block;
            margin-bottom: 5px;
            font-weight: bold;
            color: black;
            font-family: monospace;
            font-size: 15px;
        }

        .form-group select {
            margin: 0 0 10px;
        }

        .btn-green {
            text-shadow: 0 -1px 0 #669E00;
            color: #fff;
            border: 1px solid #669E00;
            background: rgb(143,196,0); /* Old browsers */
            background: -moz-linear-gradient(top, rgba(143,196,0,1) 0%, rgba(107,165,0,1) 100%); /* FF3.6+ */
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(143,196,0,1)), color-stop(100%,rgba(107,165,0,1))); /* Chrome,Safari4+ */
            background: -webkit-linear-gradient(top, rgba(143,196,0,1) 0%,rgba(107,165,0,1) 100%); /* Chrome10+,Safari5.1+ */
            background: -o-linear-gradient(top, rgba(143,196,0,1) 0%,rgba(107,165,0,1) 100%); /* Opera 11.10+ */
            background: linear-gradient(top, rgba(143,196,0,1) 0%,rgba(107,165,0,1) 100%); /* W3C */
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#8fc400', endColorstr='#6ba500',GradientType=0 ); /* IE6-9 */
        }

            .btn-green:hover {
                text-shadow: 0 1px 0 #669E00;
                border: 1px solid #669E00;
                background: rgb(198,226,120); /* Old browsers */
                background: -moz-linear-gradient(top, rgba(198,226,120,1) 0%, rgba(167,211,44,1) 100%); /* FF3.6+ */
                background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(198,226,120,1)), color-stop(100%,rgba(167,211,44,1))); /* Chrome,Safari4+ */
                background: -webkit-linear-gradient(top, rgba(198,226,120,1) 0%,rgba(167,211,44,1) 100%); /* Chrome10+,Safari5.1+ */
                background: -o-linear-gradient(top, rgba(198,226,120,1) 0%,rgba(167,211,44,1) 100%); /* Opera 11.10+ */
                background: linear-gradient(top, rgba(198,226,120,1) 0%,rgba(167,211,44,1) 100%); /* W3C */
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#c6e278', endColorstr='#a7d32c',GradientType=0 ); /* IE6-9 */
            }

        .btn-orange {
            text-shadow: 0 -1px 0 #FC730A;
            color: #fff;
            border: 1px solid #FC730A;
            background: rgb(255,168,76); /* Old browsers */
            background: -moz-linear-gradient(top, rgba(255,168,76,1) 0%, rgba(255,123,13,1) 100%); /* FF3.6+ */
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,168,76,1)), color-stop(100%,rgba(255,123,13,1))); /* Chrome,Safari4+ */
            background: -webkit-linear-gradient(top, rgba(255,168,76,1) 0%,rgba(255,123,13,1) 100%); /* Chrome10+,Safari5.1+ */
            background: -o-linear-gradient(top, rgba(255,168,76,1) 0%,rgba(255,123,13,1) 100%); /* Opera 11.10+ */
            background: linear-gradient(top, rgba(255,168,76,1) 0%,rgba(255,123,13,1) 100%); /* W3C */
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffa84c', endColorstr='#ff7b0d',GradientType=0 ); /* IE6-9 */
        }

            .btn-orange:hover {
                text-shadow: 0 1px 0 #FC730A;
                border: 1px solid #FC730A;
                background: rgb(249,191,74); /* Old browsers */
                background: -moz-linear-gradient(top, rgba(249,191,74,1) 0%, rgba(249,181,9,1) 100%); /* FF3.6+ */
                background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(249,191,74,1)), color-stop(100%,rgba(249,181,9,1))); /* Chrome,Safari4+ */
                background: -webkit-linear-gradient(top, rgba(249,191,74,1) 0%,rgba(249,181,9,1) 100%); /* Chrome10+,Safari5.1+ */
                background: -o-linear-gradient(top, rgba(249,191,74,1) 0%,rgba(249,181,9,1) 100%); /* Opera 11.10+ */
                background: linear-gradient(top, rgba(249,191,74,1) 0%,rgba(249,181,9,1) 100%); /* W3C */
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f9bf4a', endColorstr='#f9b509',GradientType=0 ); /* IE6-9 */
            }

        .btn-blue {
            text-shadow: 0 -1px 0 #1D6DC1;
            color: #fff;
            border: 1px solid #1D6DC1;
            background: rgb(122,188,255); /* Old browsers */
            background: -moz-linear-gradient(top, rgba(122,188,255,1) 0%, rgba(96,171,248,1) 44%, rgba(64,150,238,1) 100%); /* FF3.6+ */
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(122,188,255,1)), color-stop(44%,rgba(96,171,248,1)), color-stop(100%,rgba(64,150,238,1))); /* Chrome,Safari4+ */
            background: -webkit-linear-gradient(top, rgba(122,188,255,1) 0%,rgba(96,171,248,1) 44%,rgba(64,150,238,1) 100%); /* Chrome10+,Safari5.1+ */
            background: -o-linear-gradient(top, rgba(122,188,255,1) 0%,rgba(96,171,248,1) 44%,rgba(64,150,238,1) 100%); /* Opera11.10+ */
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#7abcff', endColorstr='#4096ee',GradientType=0 ); /* IE6-9 */
            background: linear-gradient(top, rgba(122,188,255,1) 0%,rgba(96,171,248,1) 44%,rgba(64,150,238,1) 100%); /* W3C */
        }

            .btn-blue:hover {
                text-shadow: 0 1px 0 #1D6DC1;
                border: 1px solid #1D6DC1;
                background: rgb(155,205,255); /* Old browsers */
                background: -moz-linear-gradient(top, rgba(155,205,255,1) 0%, rgba(134,192,250,1) 44%, rgba(110,176,242,1) 100%); /* FF3.6+ */
                background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(155,205,255,1)), color-stop(44%,rgba(134,192,250,1)), color-stop(100%,rgba(110,176,242,1))); /* Chrome,Safari4+ */
                background: -webkit-linear-gradient(top, rgba(155,205,255,1) 0%,rgba(134,192,250,1) 44%,rgba(110,176,242,1) 100%); /* Chrome10+,Safari5.1+ */
                background: -o-linear-gradient(top, rgba(155,205,255,1) 0%,rgba(134,192,250,1) 44%,rgba(110,176,242,1) 100%); /* Opera 11.10+ */
                background: linear-gradient(top, rgba(155,205,255,1) 0%,rgba(134,192,250,1) 44%,rgba(110,176,242,1) 100%); /* W3C */
                filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#9bcdff', endColorstr='#6eb0f2',GradientType=0 ); /* IE6-9 */
            }

        .inp-data input[type="text"] {
            display: inline-block;
            vertical-align: middle;
            width: 90%;
            zoom: 1;
            margin: 0;
            border: 1px solid #ccc;
            font-size: 1em;
            padding: 5px 0;
            text-indent: 5px;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            border-radius: 5px;
            background: #fff;
            -moz-box-shadow: inset 0 0 6px #ccc;
            -webkit-box-shadow: inset 0 1px 6px #ccc;
            /* box-shadow: inset 0 1px 6px #ccc; */
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
        }

        .inp-data {
            margin: 0 0 15px;
        }

        .signout, .login {
            background: url(logout-icon.png) no-repeat;
            height: 24px;
            float: right;
            position: absolute;
            top: 45px;
            right: 52px;
            color: #fff;
            /* display: inherit; */
            font-size: 20px;
            padding: 0 0 0 28px;
        }

            .signout a, .login a {
                color: #fff;
            }

                .signout a:hover, .login a:hover {
                    text-decoration: none;
                }

        .login {
            background: url(/Pictures/login.png) no-repeat 6px 6px;
        }

        .videowrap {
            width: 552px;
            height: 100%;
            border: 1px solid #ccc;
            height: 300px;
            float: left;
            margin: 0 0 10px;
            background: #eee;
        }
       
     /*  canvas { 
  width: 100%;
  height: auto;
}*/
    </style>
    <script>

        $(document).ready(function () {
            $('#pleasewait').hide();
            var a = document.getElementById('t1');
            var b = document.getElementById('t2');
            a.onkeyup = function () {
                if (this.value.length === parseInt(this.attributes["maxlength"].value)) {
                    b.focus();
                }
               
            }
            $('#patientdetails').on('hide.bs.modal', function () {
                //$("#txtname").focus();

                //$('#zoneCancelButton').hide();
               // $('#scanresult').show();
            });
            $('#patientdetails').on('shown.bs.modal', function () {
                //$('#scanresult').hide();
            });
         
        });
        function checkmrno()
        {
            var a = document.getElementById('t1').value;
            var b = document.getElementById('t2').value;
            
            if (a != "" && b != "")
            {
                var checkmrno = "@Html.Raw(HttpUtility.JavaScriptStringEncode(checkmrno))";
                var qno = document.getElementById("t1").value;
                var qno1 = document.getElementById("t2").value;
               // alert(qno + qno1);
                var mrno = qno + qno1;
                $.ajax({
                    url: checkmrno + qno,
                    crossOrgin: true, // use jsonp for cross origin request
                    dataType: 'json',
                    type: 'GET',
                    beforeSend:function()
                    {
                        $('#scanresult').hide();
                        $('#pleasewait').show();
                    },
                    success: function (data) {
                    
                        if (data == "0") { 
                            $('#scanresult').show();
                            $('#pleasewait').hide();
                            alert('No Information Available for this MR NO.');
                        }
                        else {
                            var details = [];
                            $('#scanresult').show();
                            $('#pleasewait').hide();
                            details = data.split('$');
                            document.getElementById("patientdetailsbody").innerHTML = "<h4><b><CENTER>WELCOME </b><b style=\"color:green\">Harish</b></CENTER></h4><h4><br/><b>PATIENT MR. NO. :  </b><b style=\"color:green\">" + details[0] + "</b></h4><br/><h4><b>PLEASE GO TO THE PLACE MENTIONED BELOW </b> <br/><br/><b style=\"color:green\">VISIT PAYMENT COUNTER</b></h4>  ";
                            $('#patientdetails').modal();
                        
                        }
                    },
                    error: function () {
                        $('#scanresult').show();
                        $('#pleasewait').hide();
                        alert('No Information Available for this MR NO.');
                    }
                });
            }
            else
            {
                alert('Please provide your Medical Record Number');
            }
        }
        function f2() {
            var url = '@Url.Action("Sample", "Home")';
            window.location.href = url;

        }
        $('#t1').keypress(function (e) {
           
            if (e.which != 8 && e.which != 0 && e.which != 43 && e.which != 45 && (e.which < 48 || e.which > 57)) {
                //display error message
                $("#errmsg").html("Digits Only").show().fadeOut("slow");
                return false;
            }
        });
        $('#t2').keypress(function (e) {
            if (e.which != 8 && e.which != 0 && e.which != 43 && e.which != 45 && (e.which < 48 || e.which > 57)) {
                //display error message
                $("#errmsg").html("Digits Only").show().fadeOut("slow");
                return false;
            }
        });

    </script>
</head>

<body >
       <div id="ui-preview">
              
               <h1>Follow up patients</h1>
               <div class="row col-sm-12">
                   <label style="display:block; margin:-10px 0 10px 20px">Note: Show your QR code (or) Enter your Mr.No</label>
                   <div class="col-sm-6">
                       <fieldset>
                           <legend>QR Code</legend>
                           <form class="form-inline">
                               <div class="form-group">
                                   <label>SHOW YOUR QR CODE HERE</label>
                                   <div class="videowrap">
                                       <center><canvas id="qr-canvas"></canvas></center>
                                   </div>
                               </div>
                           </form>
                       </fieldset>
                   </div>
                   <div class="col-sm-6">
                       <fieldset>
                           <legend>MR.No</legend>
                           <div class="col-sm-3 inp-data" style="margin-left:-4px">
                               <input type="text" id="t1" class="form-control " placeholder="For Eg.422" maxlength="3" autocomplete="off" required />
                           </div>
                           <span style="float: left; width: 20px; margin: 4px 0 0;">-</span>
                           <div class="col-sm-4 inp-data">
                               <input type="text" id="t2" class="form-control " placeholder="For Eg.2323" maxlength="4" autocomplete="off" required />
                           </div>
                           <div class="col-sm-12 inp-data" style="clear:both">

                               <input type="button" class="btn btn-success btn-blue" id="mrnochecking" value="SUBMIT" style="padding:10px" onclick="checkmrno()" />
                               <input type="button" class="btn btn-blue" id="b1" value="BACK" onclick="f2()" style="padding:10px;width:100px" />
                           </div>
                       </fieldset>
                           <img src="~/Pictures/idcard.png" style="width:592px; height:203px" />

                       </div>
                   </div>
           <div style="position:absolute; bottom:0; right: 0; padding:10px;">© 2016 powered by Honeywell</div>
               </div>
             

               
        
    <div class="modal fade" id="patientdetails" role="dialog" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <CENTER><h2 class="modal-title">PATIENT DETAILS</h2></CENTER>
                </div>
                <div class="modal-body">
                    <div id="patientdetailsbody" class="modal-body">

                    </div>
                  
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Re-Enter MRNO</button>
                </div>
            </div>

        </div>
    </div>
    <script>

    //setTimeout(f1, 20000);
    
        $('#t1').keypress(function (e)
        {
            if (e.which != 8 && e.which != 0 && e.which != 43 && e.which != 45 && (e.which < 48 || e.which > 57))
            {
                //display error message
                $("#errmsg").html("Digits Only").show().fadeOut("slow");
                return false;
            }
        });
        $('#t2').keypress(function (e) {
            if (e.which != 8 && e.which != 0 && e.which != 43 && e.which != 45 && (e.which < 48 || e.which > 57)) {
                //display error message
                $("#errmsg").html("Digits Only").show().fadeOut("slow");
                return false;
            }
        });
    </script>
</body>
<script type="text/javascript" src="~/Scripts/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="~/Scripts/bootstrap.min.js"></script>
<script type="text/javascript" src="~/js/qrcodelib.js"></script>
<script type="text/javascript" src="~/js/WebCodeCam.js"></script>
<script type="text/javascript" src="~/js/main.js"></script>
</html>